<!DOCTYPE html>
<html>
    <head>
        <title>VIP launching workshop - <i>running multi-modality simulations with VIP</i></title>
        <link rel="StyleSheet" href="../css/doc_main.css" type="text/css" />
    </head>
    <body>
        <h1>Hands-on: running multi-modality simulations with VIP</h1>
        This hands-on shows the main features used in VIP to run simulations.
        <br><a name="contents"></a>
        Contents:
        <ul><li><a href="#ex1">Exercise 1:</a> account creation (5 min)</li>
            <li><a href="#ex2">Exercise 2:</a> file transfer (5 min)</li>
            <li><a href="#ex3">Exercise 3:</a> X-Ray simulation with Sindbad (10 min)</li>
            <li><a href="#ex4">Exercise 4:</a> ultrasound simulation (5 min)</li>
            <li><a href="#ex5">Exercise 5:</a> platform administration (demo, 15 min)</li>
            <li><a href="#ex6">Exercise 6:</a> view ultrasound results (5 min)</li>
            <li><a href="#ref">References and acknowledgments</a></li>
        </ul>
        <h2><a name="ex1">Exercise 1</a>: account creation (5 min)</h2>

        <ul>
            <li><span style="font-weight:bold; background-color:#e3e3ff;">Connect</span> to <a href="http://vip.creatis.insa-lyon.fr">http://vip.creatis.insa-lyon.fr</a> and sign-in. Your home page should look exactly like this, with a "General", "SimuBloch" and "Simulators - tutorial" section:
        </ul>
        <img src="workshop/account3.png" alt="account3.png"/>
        <ul>
            <li>If this is not the case <b>and you don't have a VIP account</b>: <span style="font-weight:bold; background-color:#e3e3ff;">click</span> on "Sign-in" on the welcome page, fill in the form and ask for a "Tutorial" account. You should receive an activation code soon after:
          
        </ul>
        <img src="workshop/account1.png" alt="account1"/><br/><img src="workshop/account2.png" alt="account2"/>
        <ul>
            <li>If <b>you already have a VIP account</b>, but some applications do not show on the home page, <span style="font-weight:bold; background-color:#e3e3ff;">click</span> on "My account" and join group "Tutorial", then refresh the portal:</li>
        </ul>
        <img src="workshop/account4.png" alt="account4"/>
        <br/>
        <a href="#contents">Back to top</a>
        
        <h2><a name="ex2">Exercise 2:</a> file transfer (5 min)</h2>
        
        VIP provides a file transfer interface to storage distributed on the <a href="http://www.egi.eu">European Grid Infrastructure</a>. 
        It is used to store inputs and results of the simulations. 
     
        <ul>
            <li>In your home, <span style="font-weight:bold; background-color:#e3e3ff;">open</span> the "File Transfer" tool"</li>
        </ul>
        <img src="workshop/file-transfer.png" alt="file transfer"/>
        <ul>
            <li>You can access 2 directories: "Home" is private, and "Tutorial (group)" is shared among group members.</li>
            <li><span style="font-weight:bold; background-color:#e3e3ff;">Open</span> directory "Tutorial (group)" and <span style="font-weight:bold; background-color:#e3e3ff;">download file</span> "hello.txt" using the contextual (right-click) menu or the selection box and <img src="workshop/download-icon.png" alt="upload"/>:
        </ul>
        <img src="workshop/download2.png" alt="download1"/>
        <ul>
            <li>The file is downloaded in two steps: first from the grid to the portal, then from the portal to your local machine. <span style="font-weight:bold; background-color:#e3e3ff;">Click</span> on the download link in the "Pool of Transfers" to get it:
        </ul>
        <img src="workshop/download3.png" alt="download3"/>
        <ul>
            <li><span style="font-weight:bold; background-color:#e3e3ff;">Open</span> your "Home" folder, <span style="font-weight:bold; background-color:#e3e3ff;">create</span> a new directory using <img src="workshop/mkdir.png" alt="mkdir"/>, and <span style="font-weight:bold; background-color:#e3e3ff;">upload</span> a file using <img src="workshop/upload-icon.png" alt="upload"/>. In the backend, the file is uploaded to EGI, and replicated to 3 locations.</li>
            <li>Once uploaded, <span style="font-weight:bold; background-color:#e3e3ff;">Refresh</span> <img src="workshop/refresh.png" alt="refresh"/> your folder to see the file.</li>
        </ul>
        <br/>
        <a href="#contents">Back to top</a>
        
        <h2><a name="ex3">Exercise 3:</a> X-Ray simulation with Sindbad (10 min)</h2>
        
        The Sindbad X-Ray/CT simulator is available in VIP. In this exercise, we will simulate 1 X-Ray projection from the full-body XCAT model.
        <ul><li>In your home tab, <span style="font-weight:bold; background-color:#e3e3ff;">open</span> simulator "Sindbad 0.1.4 - local". A form appears, showing the simulation parameters which are described in tooltips:<ul></ul></li></ul>
        <img src="workshop/tooltips.png" alt="tooltips"/>
        <ul><li><span style="font-weight:bold; background-color:#e3e3ff;">Load</span> example "XRAY" by clicking on <img src="workshop/load-1.png" alt="load"/> in section Examples; all the inputs are filled in, except the result directory:</li></ul>
        <img src="workshop/load-example.png" alt="load example"/>
        <ul><li>To add a result directory, <span style="font-weight:bold; background-color:#e3e3ff;">click</span> on <img src="workshop/search-1.png" alt="search"/> and <span style="font-weight:bold; background-color:#e3e3ff;">select</span> your home:</li></ul>
        <img src="workshop/select-home.png" alt="select home"/>
        <ul>
            <li><span style="font-weight:bold; background-color:#e3e3ff;">Click on launch</span> to launch the simulation.</li>
            <li>In your home, <span style="font-weight:bold; background-color:#e3e3ff;">open</span> <img src="workshop/monitor-icon.png" alt="monitor-icon"/> to monitor your simulation:</li>   
        </ul>
        <img src="workshop/monitor-list.png" alt="monitor list"/>
        <ul>
            <li><span style="font-weight:bold; background-color:#e3e3ff;">Click</span> on your simulation. A tab appears showing the progress of the execution:</li>
        </ul>
        <img src="workshop/monitor1.png" alt="monitor1"/>
        <ul>
            <li>On the left, tab "Jobs summary" shows information about jobs statuses:</li>
        </ul>
        <img src="workshop/monitor2.png" alt="monitor2"/>
        <ul>
            <li><b>Known bug:</b> if no simulation job is created after a few minutes, i.e. the "Jobs summary" tab in your simulation still has no job:
        </ul>
        <img src="workshop/bug1.png" alt="bug"/>
        <ul>
            <li>Then kill your simulation and relaunch it using the contextual menu in the simulation monitor: <img src="workshop/monitor-icon.png" alt="monitor"/>
        </ul>
        <img src="workshop/kill.png" alt="kill"/>
        <ul><li>When the simulation is finished (this should take around 5 minutes), <span style="font-weight:bold; background-color:#e3e3ff;">download</span> the results from the main simulation tab:</li></ul>
        <img src="workshop/results-download.png" alt="results-download"/>
        
        <ul><li>The simulated image is image_0.mhd/image_0.raw in results.tar.gz. <span style="font-weight:bold; background-color:#e3e3ff;">Uncompress</span> results.tar.gz and <span style="font-weight:bold; background-color:#e3e3ff;">open</span> image_0.mhd with an image viewer. If you don't have a .mhd viewer installed on your computer, you can use VV (<a href="http://www.creatis.insa-lyon.fr/rio/vv?action=AttachFile&do=get&target=vv-1.3-win64.zip">Windows</a>, <a href="http://www.creatis.insa-lyon.fr/rio/vv?action=AttachFile&do=get&target=vv-1.3-linux64.sh">Linux 64 bits</a>) or medInria (<a href="http://med.inria.fr/the-app/downloads">all platforms</a>):</li>
            <li>The simulated image should look like this:</li>
        </ul>
        <img src="workshop/xray.png" alt="xray"/>
            <br/>
            <a href="#contents">Back to top</a>
        
        <h2><a name="ex4">Exercise 4:</a> ultrasound simulation (5 min)</h2>
        The FIELD-II ultrasound simulator is available in VIP. In this exercise, we will simulate a parasternal short-axis echocardiography. As the simulated image is composed of 122 lines and each line requires a few minutes of CPU time, the execution will be parallelized on EGI.
        <ul><li>In your home tab, <span style="font-weight:bold; background-color:#e3e3ff;">open</span> simulator "FIELD-II v0.4" and <span style="font-weight:bold; background-color:#e3e3ff;">load</span> example "2Dt cardiac sequence - parasternal short axis - 1 frame".</li>
        </ul>
        <img src="workshop/load-field.png" alt="load-field"/>
        <ul>
            <li><span style="font-weight:bold; background-color:#e3e3ff;">Launch</span> the simulation and <span style="font-weight:bold; background-color:#e3e3ff;">open</span> the simulation monitor. After some time, 6 jobs are submitted: 5 to compute the image lines, and 1 to merge them in a single image:</li>
        </ul>
        <img src="workshop/field-running.png" alt="field-running"/>
        <ul>
            <li><b>Known bug:</b> if no simulation job is created after a few minutes, i.e. the "Jobs summary" tab in your simulation still has no job:
        </ul>
        <img src="workshop/bug1.png" alt="bug"/>
        <ul>
            <li>Then kill your simulation and relaunch it using the contextual menu in the simulation monitor: <img src="workshop/monitor-icon.png" alt="monitor"/>
        </ul>
        <img src="workshop/kill.png" alt="kill"/>
        <ul><li>The simulation will take some time to complete. We will let it run while we move to exercise 5.</li></ul>
        
     
        <br/>
        <a href="#contents">Back to top</a>
        
        <h2><a name="ex5">Exercise 5:</a> platform administration (demo, 15 min)</h2>
            <p>In this exercise, we will demonstrate how the platform is monitored and managed by administrators.</p>
            <p>The demonstration will consist of managing:</p>
            <ul><li>Users and groups</li></ul>
            <img src="workshop/admin-users.png" alt="Add/Edit Users"/><br />
            <img src="workshop/admin-groups.png" alt="Add/Edit Groups"/>
            <ul><li>Applications and classes</li></ul>
            <img src="workshop/admin-apps.png" alt="Add/Edit Applications"/><br />
            <img src="workshop/admin-classes.png" alt="Add/Edit Classes"/>
            <ul><li>Data transfer operations</li></ul>
            <img src="workshop/admin-data.png" alt="Data transfer monitoring"/>
            <ul><li>Simulations</li></ul>
            <img src="workshop/admin-simulations.png" alt="Data transfer monitoring"/><br />
       
        <a href="#contents">Back to top</a>
        
        <h2><a name="ex6">Exercise 6:</a> view ultrasound results (5 min)</h2>
        <ul><li>Your ultrasound simulation launched in Exercise 4 should now be complete. To visualize its results, <span style="font-weight:bold; background-color:#e3e3ff;">download</span> image.mhd and image.raw from the simulation panel accessed from simulation monitor:<img src="workshop/monitor-icon.png" alt="monitor"/>:</li></ul>
       <img src="workshop/visu-US1.png" alt="resultsUS"/>
       <ul>
           <li>To visualize the simulated image, <span style="font-weight:bold; background-color:#e3e3ff;">open</span> image.mhd with an image viewer. If you don't have a .mhd viewer installed on your computer, you can use VV (<a href="http://www.creatis.insa-lyon.fr/rio/vv?action=AttachFile&do=get&target=vv-1.3-win64.zip">Windows</a>, <a href="http://www.creatis.insa-lyon.fr/rio/vv?action=AttachFile&do=get&target=vv-1.3-linux64.sh">Linux 64 bits</a>) or medInria (<a href="http://med.inria.fr/the-app/downloads">all platforms</a>).</li>
       </ul>
       <img height="300" src="workshop/visuUS2.png" alt="resultsUS2"/><br/>
       <ul>
           <li><span style="font-weight:bold; background-color:#e3e3ff;">Open</span> tab "Performance statistics" to view performance statistics about the simulation:</li>
       </ul>
       <img src="workshop/stats.png" alt="performance"/>
       
       <br/>
       That's it, we hope you enjoyed the session.<br/>
       <br/>
        <a href="#contents">Back to top</a>
        
       <h2><a name="ref">References and acknowledgments:</a></h2>
       The <a href="http://www.creatis.insa-lyon.fr/vip">Virtual Imaging Platform</a> is a French project funded by <a href="http://www.agence-nationale-recherche.fr">ANR</a> under grant ANR-09-COSI-03.
       <ul>
           <li>The grid infrastructure is provided by <a href="http://www.egi.eu">EGI</a>, with contributions from many National Grid Institutions.
           <li>Administration and support for the <a href="http://dirac.france-grilles.fr">DIRAC</a> scheduler is provided by <a href="http://www.france-grilles.fr">France-Grilles</a></li>
           <li>The <a href="http://modalis.i3s.unice.fr/moteur2">MOTEUR</a> workflow engine is developed at I3S</li>
           <li><a href="http://server.oersted.dtu.dk/personal/jaj/field">FIELD-II</a> is citationware.  If you are publishing any work, where this program has been used, please remember that it was obtained free of charge. You must reference the two papers shown \ below and the name of the program Field II must be mentioned in the publication.<ol>
                   <li>    J.A.Jensen: Field: A Program for Simulating Ultrasound Systems, Paper presented at the 10th Nordic-Baltic Conference on Biomedical Imaging Published in Medical & Biological Engineering & Computing, pp. 351-353, Volume 34, Supplement 1, Part 1, 1996.</li>
                   <li>J.A.Jensen and N.B.Svendsen: Calculation of pressure fields from arbitrarily shaped, apodized, and excited ultrasound transducers, IEEE Trans.Ultrason., Ferroelec., Freq.Contr., 39, pp. 262-267, 1992. </li>
               </ol></li>
               <li>Sindbad is developed at <a href="http://www.leti.fr/">CEA-LETI-MINATEC</a>. Access to the simulator has to be specifically requested to Joachim Tabary (joachim.tabary@cea.fr).</li>
               <li>The ultrasound simulation was designed in the <a href="http://www.creatis.insa-lyon.fr/us-tagging">US-Tagging</a> project:  M. Alessandrini, H. Liebgott, D. Friboulet, and O. Bernard, "Simulation of realilstic echocardiographic sequences for ground-truth validation of motion estimation", IEEE International Conference on Image Processing (ICIP), Orlando, Florida, USA, 2012</li>
       <li><a href="http://www.creatis.insa-lyon.fr/rio/vv">VV</a> is from CREATIS, <a href="http://med.inria.fr/">medInria</a> is from INRIA</li>
        <li>About the VIP platform:  "A Virtual Imaging Platform for multi-modality medical image simulation", Tristan Glatard, Carole Lartizien, Bernard Gibaud, Rafael Ferreira da Silva, Germain Forestier, Fr&eacute;d&eacute;ric Cervenansky, Martino Alessandrini, Hugues Benoit-Cattin, Olivier Bernard, Sorina Camarasu-Pop, Nadia Cerezo, Patrick Clarysse, Alban Gaignard, Patrick Hugonnard, Herv&eacute; Liebgott, Simon Marache, Adrien Marion, Johan Montagnat, Joachim Tabary, and Denis Friboulet, IEEE Transactions on Medical Imaging, in press, 2012</li>
       </ul> 
    </body>
</html>
