#!/bin/bash
if [ $# -ne $number ]
then
#set($listValues = "" )
#foreach( $input in $inputList)
#set($listValues = "$listValues <$input.name>" )
#end
#foreach( $output in $outputList)
#set($listValues = "$listValues <$output.name>" )
#end
echo "usage: $0 $listValues"
exit 1
fi

DOCKER_IMAGE=$dockerImage
#set($i =$0 )
#foreach( $input in $inputList)
#set($i =$i +1 )
PARAM${i}KEY="$input.commandLineKey"
PARAM${i}VALUE="$${i}"
#set($commandLine =$commandLine.replace("$input.commandLineKey","$$i"))
#end

#foreach( $output in $outputList)
#set($i =$i +1 )
#if(!$output.commandLineKey.equals(""))
PARAM${i}KEY="$output.commandLineKey"
PARAM${i}VALUE="$${i}"
#set($commandLine =$commandLine.replace("$output.commandLineKey","$$i"))
#end
#end

cat << DOCKERJOB > .dockerjob.sh
#!/bin/bash
$commandLine
DOCKERJOB
chmod 755 .dockerjob.sh 

docker run -v $PWD:/gasw-execution-dir -v $PWD/../cache:$PWD/../cache -w /gasw-execution-dir $dockerImage  ./.dockerjob.sh 

if [ $? != 0 ]
then
    echo "Application execution failed!"
    exit 1
fi
echo "Execution of VIP wrapper script in Docker container completed."
